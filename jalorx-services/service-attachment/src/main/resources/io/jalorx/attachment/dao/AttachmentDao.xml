<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="io.jalorx.attachment.dao.AttachmentDao">

	<!-- <cache /> -->

	<!-- ///////////////////////////基础接口定义///////////////////////////////// -->

	<select id="getById" resultType="io.jalorx.attachment.entity.Attachment">
		SELECT
		T.*
		FROM TPL_FILE_T T
		WHERE T.ID = #{id}
	</select>
	
	<select id="getByBatchNo" resultType="io.jalorx.attachment.entity.Attachment">
		SELECT
		T.*
		FROM TPL_FILE_T T
		WHERE T.BATCH_NO = #{batchNo}
	</select>

	<select id="getCount" resultType="int">
		SELECT
		count(1)
		FROM TPL_FILE_T T
	</select>

	<select id="selectAll" resultType="io.jalorx.attachment.entity.Attachment">
		SELECT
		T.*
		FROM TPL_FILE_T T
		<filter open="where (" close=")" />
	</select>

	<select id="select" resultType="io.jalorx.attachment.entity.Attachment" pageable="true">
		select T.* FROM TPL_FILE_T T
		<filter open="where (" close=")" />
		ORDER BY T.ID
	</select>
	
	<sql id="base_insert_sql">
		INSERT INTO TPL_FILE_T
		(<if test="id != null">ID,</if>ATTACH_TYPE,BATCH_NO,FILE_PATH, FILE_NAME, FILE_SIZE,FILE_UID , 
		TENANT_ID,APP_NAME,APP_SCOPE,
		REVISION, CREATE_USER_ID, CREATE_DATE , LAST_UPDATE_USER_ID , LAST_UPDATE_DATE)
		VALUES
		(<if test="id != null">#{id,jdbcType=NUMERIC},</if>
		#{attachType,jdbcType=VARCHAR},
		#{batchNo,jdbcType=VARCHAR},
		#{filePath,jdbcType=VARCHAR},
		#{fileName,jdbcType=VARCHAR},
		#{fileSize,jdbcType=NUMERIC},
		#{fileUid,jdbcType=VARCHAR},
		#{tenantId,jdbcType=VARCHAR},#{appName,jdbcType=VARCHAR},#{appScope,jdbcType=VARCHAR},
		#{revision,jdbcType=NUMERIC},
		#{currentUserId,jdbcType=NUMERIC},
		#{_currentDate},
		#{currentUserId,jdbcType=NUMERIC},
		#{_currentDate})
	</sql>
	
	<insert id="insert" parameterType="io.jalorx.attachment.entity.Attachment" useGeneratedKeys="true" keyColumn="ID" keyProperty="id">
		<selectKey resultType="long" keyProperty="id" order="BEFORE" databaseId="oracle">
        	SELECT TPL_FILE_S.NEXTVAL AS value FROM dual  
		</selectKey>
		<include refid="base_insert_sql" />
	</insert>
	
	<update id="update" parameterType="io.jalorx.attachment.entity.Attachment">
		UPDATE TPL_FILE_T SET
		BATCH_NO = #{batchNo,jdbcType=VARCHAR},
		FILE_PATH = #{filePath,jdbcType=VARCHAR},
		FILE_NAME = #{fileName,jdbcType=VARCHAR},
		FILE_SIZE = #{fileSize,jdbcType=NUMERIC},
		FILE_UID = #{fileUid,jdbcType=VARCHAR},
		REVISION = #{revision,jdbcType=NUMERIC},
		LAST_UPDATE_USER_ID = #{lastUpdateUserId,jdbcType=NUMERIC},
		LAST_UPDATE_DATE = #{_currentDate,jdbcType=DATE}
		WHERE ID = #{id,jdbcType=NUMERIC}
	</update>


	<delete id="deleteById">
		DELETE FROM TPL_FILE_T
		WHERE ID = #{id}
	</delete>
	
	<delete id="deleteByIds">
		DELETE FROM TPL_FILE_T
		WHERE ID in
		<foreach item="id" collection="ids" open="(" separator=","
			close=")">
			#{id}
		</foreach>
	</delete>
	
	<!-- //////////////////////////////////////////////////////////// -->

	<!-- 
	<select id="findNavbarMenus" resultType="io.jalorx.attachment.entity.Attachment">
		SELECT
		T.*
		FROM oa_orgnazition_t T
		WHERE T.org_code = ''
	</select>
	-->
	
	<select id="getByName" resultType="int">
		SELECT
		count(1)
		FROM TPL_FILE_T T
		WHERE T.file_name = #{fileName}
	</select>
	
</mapper>

